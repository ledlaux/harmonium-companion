<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Harmonium Companion</title>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
      <script src="https://unpkg.com/@tonejs/midi"></script>
      <link
         href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;1,400&family=Montserrat:wght@300;400;600&display=swap"
         rel="stylesheet">
      <link rel="stylesheet" href="style.css">
   </head>
   <body>
        <div id="overlay">
         <div id="overlay-content">
            <!-- Split title -->
            <div id="overlay-title">
               <span class="title-small">Bytes & Bellows</span>
               <span class="title-large">Harmonium Companion</span>
            </div>
            <table id="controls-table">
               <thead>
                  <tr>
                     <th>Action</th>
                     <th>Input</th>
                  </tr>
               </thead>
               <tbody>
                  <tr>
                     <td>Play Notes</td>
                     <td>Keyboard and MIDI</td>
                  </tr>
                  <tr>
                     <td>Pump Bellows</td>
                     <td>Spacebar (manual mode)</td>
                  </tr>
                  <tr>
                     <td>Sustain</td>
                     <td>Shift key</td>
                  </tr>
               </tbody>
            </table>
            <button id="start-btn">PRESS TO PLAY</button>
            <div id="overlay-copyright">
               © 2026 Vadims Maksimovs | github.com/ledlaux
            </div>
         </div>
      </div>
      <div class="zoom-viewport">
         <img src="./images/harmonium.png" class="synth-bg">
         <div class="brand-container">
            <span class="brand-text">Bytes & Bellows</span>
            <span class="brand-subtitle">Harmonium Companion</span>
         </div>
         <div class="raga-display-overlay">
            <span class="brand-subtitle"
               style="font-size: 8px; opacity: 1; margin-bottom: 4px; background: none;">List of ragas</span>
            <div class="raga-stepper">
               <button class="stepper-btn stepper-left">&#10094;</button>
               <span id="current-raga-name" class="raga-name-display">Chromatic</span>
               <button class="stepper-btn stepper-right">&#10095;</button>
            </div>
         </div>
         <div class="bellows-row" id="pump-area">
            <div class="switch-group">
               <span class="toggle-label">AUTO</span>
               <label class="switch">
               <input type="checkbox" id="manual-toggle">
               <span class="slider-pump"></span>
               </label>
            </div>
            <div class="meter-container" id="meter-ui" style="display: none;">
               <div id="air-fill"></div>
            </div>
         </div>
          <div class="top-ui-row">
   <div class="notation-container">
      <div class="switch-group">
         <label class="switch">
            <input type="checkbox" id="notation-checkbox">
            <span class="slider-pump"></span>
         </label>
      </div>
   </div>
   <div class="octave-led-bar">
      <div class="oct-unit" data-octave="-1">
         <div class="oct-led" id="oct-low"></div>
      </div>
      <div class="oct-unit" data-octave="0">
         <div class="oct-led active" id="oct-mid"></div>
      </div>
      <div class="oct-unit" data-octave="1">
         <div class="oct-led" id="oct-high"></div>
      </div>
   </div>
   <div class="transpose-group">
      <button class="trans-btn trans-left">−</button>
      <span class="trans-val" id="trans-display">T</span>
      <button class="trans-btn trans-right">+</button>
   </div>

</div>
         <canvas id="visualizer-canvas"></canvas>
         <div class="controls-grid">
            <div class="knob-container">
               <span class="knob__label">Volume</span>
               <input type="range" id="vol" min="-40" max="0" value="-2">
            </div>
            <div class="knob-container">
               <span class="knob__label">Sustain</span>
               <input type="range" id="sus" min="0.1" max="4" step="0.1" value="0.1">
            </div>
            <div class="knob-container">
               <span class="knob__label">Chorus</span>
               <input type="range" id="chorus-slider" min="0" max="0.3" step="0.01" value="0">
            </div>
            <div class="knob-container">
               <span class="knob__label">Reverb</span>
               <input type="range" id="rev" min="0" max="1" step="0.01" value="0">
            </div>
         </div>
         <div class="keyboard-wrapper">
            <div id="keyboard" class="keyboard"></div>
         </div>
         <div class="master-panel">
            <div class="switch-group">
               <span class="toggle-label">Sub-Oct</span>
               <label class="switch">
               <input type="checkbox" id="sub-oct-toggle">
               <span class="slider-pump"></span>
               </label>
            </div>
            <div class="switch-group">
               <span class="toggle-label">Coupler</span>
               <label class="switch">
               <input type="checkbox" id="coupler-toggle">
               <span class="slider-pump"></span>
               </label>
            </div>
          <div class="switch-group" id="hold-btn" style="cursor:pointer">
    <span class="toggle-label">Hold</span>
</div>
         <div class="switch-group" id="midi-control-group">
    <label for="midi-select" class="midi-label" id="midi-trigger">MIDI</label>
    <select id="midi-select">
        <option value="">MIDI (OFF)</option>
    </select> 
</div>
<div class="control-item strict-control">
    <label class="switch">
        <input type="checkbox" id="strict-raga-toggle">
        <span class="slider"></span>
    </label>
    <label for="strict-raga-toggle" class="lock-icon-label" title="Strict Raga">
        &#x1F512;
    </label>
</div>

<div class="transport-deck">
    <div class="deck-section file-controls">
        <input type="file" id="song-file-input" accept=".mid,.midi" style="display: none;">
        <label for="song-file-input" class="brass-btn song-upload-label" id="song-label">
            LOAD SONG
        </label>
    </div>

    <div class="deck-section playback-controls">
        <button id="midi-play" class="brass-btn transport-btn">▶</button>
        <button id="midi-stop" class="brass-btn transport-btn">■</button>
    </div>

    <div class="deck-section progress-display">
        <div class="midi-progress-container">
            <div id="midi-progress-bar"></div>
        </div>

        <div class="tempo-control">
            <input type="range" id="tempo-slider" min="40" max="240" value="120">
            <div class="tempo-meta">
                <span id="bpm-display">120</span>
                <label class="tempo-label">BPM</label>
            </div>
        </div>
    </div>
</div>
            </div>
         </div>
      </div>
      <script src="main.js"></script>
   </body>
</html>
